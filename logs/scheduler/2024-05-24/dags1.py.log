[2024-05-24T11:21:58.709+0000] {processor.py:156} INFO - Started process (PID=34) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:21:58.711+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:21:58.713+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:21:58.713+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:21:59.890+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:21:59.885+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 12, in <module>
    from transform_script import transfrom  # импортируем функцию transfrom из скрипта
  File "/opt/airflow/dags/transform_script.py", line 2, in <module>
    from tqdm import tqdm
ModuleNotFoundError: No module named 'tqdm'
[2024-05-24T11:21:59.891+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:21:59.937+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/dags1.py took 1.230 seconds
[2024-05-24T11:22:45.953+0000] {processor.py:156} INFO - Started process (PID=56) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:22:45.961+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:22:45.968+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:22:45.968+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:23:36.414+0000] {processor.py:156} INFO - Started process (PID=59) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:23:36.431+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:23:36.495+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:23:36.487+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:27:11.600+0000] {processor.py:156} INFO - Started process (PID=62) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:27:11.606+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:27:11.611+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:27:11.610+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:27:41.648+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:27:41.637+0000] {timeout.py:68} ERROR - Process timed out, PID: 62
[2024-05-24T11:27:41.702+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:27:41.654+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 4, in <module>
    import pandas as pd
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/__init__.py", line 50, in <module>
    from pandas.core.api import (
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/api.py", line 29, in <module>
    from pandas.core.arrays import Categorical
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/arrays/__init__.py", line 7, in <module>
    from pandas.core.arrays.categorical import Categorical
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/arrays/categorical.py", line 113, in <module>
    from pandas.core.strings.object_array import ObjectStringArrayMixin
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/strings/__init__.py", line 30, in <module>
    from pandas.core.strings.accessor import StringMethods
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/strings/accessor.py", line 134, in <module>
    class StringMethods(NoNewAttributesMixin):
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/strings/accessor.py", line 1898, in StringMethods
    def lstrip(self, to_strip=None):
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/util/_decorators.py", line 487, in __call__
    func.__doc__ = dedent(self.join.join(docitems))
  File "/usr/local/lib/python3.7/textwrap.py", line 431, in dedent
    indents = _leading_whitespace_re.findall(text)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/dags1.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#reducing-dag-complexity, PID: 62
[2024-05-24T11:27:41.711+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:27:52.120+0000] {processor.py:181} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3243, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 310, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 868, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 476, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 146, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 143, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 256, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 371, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 666, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/create.py", line 590, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 584, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: could not translate host name "postgres" to address: Temporary failure in name resolution


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 177, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 161, in _handle_dag_file_processing
    callback_requests=callback_requests,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 75, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 771, in process_file
    self.update_import_errors(session, dagbag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 558, in update_import_errors
    existing_import_error_files = [x.filename for x in session.query(errors.ImportError.filename).all()]
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/query.py", line 2759, in all
    return self._iter().all()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/query.py", line 2897, in _iter
    execution_options={"_sa_orm_load_options": self.load_options},
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1688, in execute
    conn = self._connection_for_bind(bind)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1530, in _connection_for_bind
    engine, execution_options
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 747, in _connection_for_bind
    conn = bind.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3197, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3276, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3247, in _wrap_pool_connect
    e, dialect, self
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2101, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3243, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 310, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 868, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 476, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 146, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 143, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 256, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 371, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 666, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/create.py", line 590, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 584, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2024-05-24T11:28:27.099+0000] {processor.py:156} INFO - Started process (PID=75) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:28:27.113+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:28:27.131+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:28:27.130+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:28:42.914+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:28:42.865+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 12, in <module>
    from transform_script import transfrom  # импортируем функцию transfrom из скрипта
  File "/opt/airflow/dags/transform_script.py", line 2, in <module>
    from tqdm import tqdm
ModuleNotFoundError: No module named 'tqdm'
[2024-05-24T11:28:42.934+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:28:47.331+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/dags1.py took 20.322 seconds
[2024-05-24T11:29:19.802+0000] {processor.py:156} INFO - Started process (PID=87) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:29:19.804+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:29:19.804+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:29:19.804+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:32:25.044+0000] {processor.py:156} INFO - Started process (PID=34) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:32:25.046+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:32:25.046+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:32:25.046+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:32:25.731+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:32:25.730+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 12, in <module>
    from transform_script import transfrom  # импортируем функцию transfrom из скрипта
  File "/opt/airflow/dags/transform_script.py", line 2, in <module>
    from tqdm import tqdm
ModuleNotFoundError: No module named 'tqdm'
[2024-05-24T11:32:25.732+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:32:25.751+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/dags1.py took 0.713 seconds
[2024-05-24T11:32:55.884+0000] {processor.py:156} INFO - Started process (PID=64) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:32:55.885+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:32:55.886+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:32:55.886+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:32:57.319+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:32:57.317+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 12, in <module>
    from transform_script import transfrom  # импортируем функцию transfrom из скрипта
  File "/opt/airflow/dags/transform_script.py", line 2, in <module>
    from tqdm import tqdm
ModuleNotFoundError: No module named 'tqdm'
[2024-05-24T11:32:57.320+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:32:57.336+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/dags1.py took 1.453 seconds
[2024-05-24T11:33:47.795+0000] {processor.py:156} INFO - Started process (PID=33) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:33:47.796+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:33:47.797+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:33:47.797+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:33:48.425+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:33:48.425+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 12, in <module>
    from transform_script import transfrom  # импортируем функцию transfrom из скрипта
  File "/opt/airflow/dags/transform_script.py", line 2, in <module>
    from tqdm import tqdm
ModuleNotFoundError: No module named 'tqdm'
[2024-05-24T11:33:48.426+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:33:48.445+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/dags1.py took 0.653 seconds
[2024-05-24T11:34:19.755+0000] {processor.py:156} INFO - Started process (PID=54) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:34:19.764+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:34:19.768+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:34:19.765+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:34:50.680+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:34:50.674+0000] {timeout.py:68} ERROR - Process timed out, PID: 54
[2024-05-24T11:34:50.683+0000] {logging_mixin.py:117} WARNING - Exception ignored in: <function WeakKeyDictionary.__init__.<locals>.remove at 0x7f2fcf5dcd40>
[2024-05-24T11:34:50.683+0000] {logging_mixin.py:117} WARNING - Traceback (most recent call last):
[2024-05-24T11:34:50.684+0000] {logging_mixin.py:117} WARNING -   File "/usr/local/lib/python3.7/weakref.py", line 358, in remove
[2024-05-24T11:34:50.687+0000] {logging_mixin.py:117} WARNING -     def remove(k, selfref=ref(self)):
[2024-05-24T11:34:50.688+0000] {logging_mixin.py:117} WARNING -   File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
[2024-05-24T11:34:50.695+0000] {logging_mixin.py:117} WARNING -     raise AirflowTaskTimeout(self.error_message)
[2024-05-24T11:34:50.695+0000] {logging_mixin.py:117} WARNING - airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/dags1.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#reducing-dag-complexity, PID: 54
[2024-05-24T11:34:53.456+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:34:53.146+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 12, in <module>
    from transform_script import transfrom  # импортируем функцию transfrom из скрипта
  File "/opt/airflow/dags/transform_script.py", line 2, in <module>
    from tqdm import tqdm
ModuleNotFoundError: No module named 'tqdm'
[2024-05-24T11:34:53.758+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:35:27.866+0000] {processor.py:156} INFO - Started process (PID=64) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:35:27.874+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:35:27.887+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:35:27.887+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:36:42.087+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:36:42.083+0000] {timeout.py:68} ERROR - Process timed out, PID: 64
[2024-05-24T11:36:45.722+0000] {processor.py:156} INFO - Started process (PID=68) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:36:45.725+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:36:45.728+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:36:45.728+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:36:46.874+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:36:46.856+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 12, in <module>
    from transform_script import transfrom  # импортируем функцию transfrom из скрипта
  File "/opt/airflow/dags/transform_script.py", line 2, in <module>
    from tqdm import tqdm
ModuleNotFoundError: No module named 'tqdm'
[2024-05-24T11:36:46.876+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:36:46.941+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/dags1.py took 1.223 seconds
[2024-05-24T11:37:25.799+0000] {processor.py:156} INFO - Started process (PID=90) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:37:25.842+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:37:25.845+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:37:25.845+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:37:30.474+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:37:30.407+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 12, in <module>
    from transform_script import transfrom  # импортируем функцию transfrom из скрипта
  File "/opt/airflow/dags/transform_script.py", line 2, in <module>
    from tqdm import tqdm
ModuleNotFoundError: No module named 'tqdm'
[2024-05-24T11:37:30.495+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:37:33.433+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/dags1.py took 7.701 seconds
[2024-05-24T11:38:03.853+0000] {processor.py:156} INFO - Started process (PID=92) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:38:03.861+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:38:03.867+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:38:03.866+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:39:33.796+0000] {processor.py:156} INFO - Started process (PID=95) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:39:33.806+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:39:33.811+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:39:33.811+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:39:46.048+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:39:46.011+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 12, in <module>
    from transform_script import transfrom  # импортируем функцию transfrom из скрипта
  File "/opt/airflow/dags/transform_script.py", line 2, in <module>
    from tqdm import tqdm
ModuleNotFoundError: No module named 'tqdm'
[2024-05-24T11:39:46.052+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:39:46.936+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/dags1.py took 42.694 seconds
[2024-05-24T11:40:19.703+0000] {processor.py:156} INFO - Started process (PID=108) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:40:19.709+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:40:19.710+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:40:19.710+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:40:27.965+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:40:27.937+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 12, in <module>
    from transform_script import transfrom  # импортируем функцию transfrom из скрипта
  File "/opt/airflow/dags/transform_script.py", line 2, in <module>
    from tqdm import tqdm
ModuleNotFoundError: No module named 'tqdm'
[2024-05-24T11:40:27.966+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:40:28.167+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/dags1.py took 8.476 seconds
[2024-05-24T11:40:59.325+0000] {processor.py:156} INFO - Started process (PID=110) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:40:59.337+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:40:59.362+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:40:59.355+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:41:37.147+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:41:35.363+0000] {timeout.py:68} ERROR - Process timed out, PID: 110
[2024-05-24T11:41:52.496+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:41:43.378+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 4, in <module>
    import pandas as pd
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/__init__.py", line 22, in <module>
    from pandas.compat import (
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/compat/__init__.py", line 15, in <module>
    from pandas.compat.numpy import (
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/compat/numpy/__init__.py", line 7, in <module>
    from pandas.util.version import Version
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/util/__init__.py", line 1, in <module>
    from pandas.util._decorators import (  # noqa
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/util/_decorators.py", line 14, in <module>
    from pandas._libs.properties import cache_readonly  # noqa
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/_libs/__init__.py", line 13, in <module>
    from pandas._libs.interval import Interval
  File "pandas/_libs/interval.pyx", line 1, in init pandas._libs.interval
  File "pandas/_libs/hashtable.pyx", line 1, in init pandas._libs.hashtable
  File "pandas/_libs/missing.pyx", line 1, in init pandas._libs.missing
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/_libs/tslibs/__init__.py", line 31, in <module>
    from pandas._libs.tslibs.conversion import (
  File "pandas/_libs/tslibs/conversion.pyx", line 63, in init pandas._libs.tslibs.conversion
  File "<frozen importlib._bootstrap>", line 416, in parent
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/dags1.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#reducing-dag-complexity, PID: 110
[2024-05-24T11:41:52.602+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:42:09.290+0000] {processor.py:156} INFO - Started process (PID=112) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:42:09.293+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:42:09.306+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:42:09.306+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:42:40.894+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:42:39.501+0000] {timeout.py:68} ERROR - Process timed out, PID: 112
[2024-05-24T11:42:41.080+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:42:40.905+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 4, in <module>
    import pandas as pd
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/__init__.py", line 50, in <module>
    from pandas.core.api import (
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/api.py", line 29, in <module>
    from pandas.core.arrays import Categorical
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/arrays/__init__.py", line 7, in <module>
    from pandas.core.arrays.categorical import Categorical
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/arrays/categorical.py", line 113, in <module>
    from pandas.core.strings.object_array import ObjectStringArrayMixin
  File "<frozen importlib._bootstrap>", line 983, in _find_and_load
  File "<frozen importlib._bootstrap>", line 967, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 677, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 724, in exec_module
  File "<frozen importlib._bootstrap_external>", line 818, in get_code
  File "<frozen importlib._bootstrap_external>", line 916, in get_data
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/dags1.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#reducing-dag-complexity, PID: 112
[2024-05-24T11:42:41.083+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:42:52.562+0000] {processor.py:181} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3243, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 310, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 868, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 476, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 146, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 143, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 256, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 371, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 666, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/create.py", line 590, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 584, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: could not translate host name "postgres" to address: Temporary failure in name resolution


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 177, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 161, in _handle_dag_file_processing
    callback_requests=callback_requests,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 75, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 771, in process_file
    self.update_import_errors(session, dagbag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 558, in update_import_errors
    existing_import_error_files = [x.filename for x in session.query(errors.ImportError.filename).all()]
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/query.py", line 2759, in all
    return self._iter().all()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/query.py", line 2897, in _iter
    execution_options={"_sa_orm_load_options": self.load_options},
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1688, in execute
    conn = self._connection_for_bind(bind)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1530, in _connection_for_bind
    engine, execution_options
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 747, in _connection_for_bind
    conn = bind.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3197, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3276, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3247, in _wrap_pool_connect
    e, dialect, self
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2101, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3243, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 310, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 868, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 476, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 146, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 143, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 256, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 371, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 666, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/create.py", line 590, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 584, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2024-05-24T11:43:31.657+0000] {processor.py:156} INFO - Started process (PID=116) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:43:32.060+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:43:43.931+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:43:38.802+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:44:21.398+0000] {processor.py:156} INFO - Started process (PID=118) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:44:21.403+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:44:21.404+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:44:21.404+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:48:36.473+0000] {processor.py:156} INFO - Started process (PID=120) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:48:36.478+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:48:36.491+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:48:36.491+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:49:40.333+0000] {processor.py:156} INFO - Started process (PID=132) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:49:40.656+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:49:43.053+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:49:41.106+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:50:43.377+0000] {processor.py:156} INFO - Started process (PID=135) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:50:43.383+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:50:43.390+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:50:43.390+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:51:33.913+0000] {processor.py:156} INFO - Started process (PID=138) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:51:33.914+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:51:33.915+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:51:33.915+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:55:17.153+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:55:16.979+0000] {timeout.py:68} ERROR - Process timed out, PID: 138
[2024-05-24T11:55:17.549+0000] {processor.py:156} INFO - Started process (PID=140) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:55:17.558+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:55:17.559+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:55:17.559+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:55:47.898+0000] {processor.py:156} INFO - Started process (PID=152) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:55:47.907+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:55:47.915+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:55:47.915+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:55:50.367+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:55:50.349+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 12, in <module>
    from transform_script import transfrom  # импортируем функцию transfrom из скрипта
  File "/opt/airflow/dags/transform_script.py", line 2, in <module>
    from tqdm import tqdm
ModuleNotFoundError: No module named 'tqdm'
[2024-05-24T11:55:50.369+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:56:00.425+0000] {processor.py:181} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3243, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 310, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 868, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 476, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 146, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 143, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 256, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 371, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 666, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/create.py", line 590, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 584, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: could not translate host name "postgres" to address: Temporary failure in name resolution


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 177, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 161, in _handle_dag_file_processing
    callback_requests=callback_requests,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 75, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 771, in process_file
    self.update_import_errors(session, dagbag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 558, in update_import_errors
    existing_import_error_files = [x.filename for x in session.query(errors.ImportError.filename).all()]
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/query.py", line 2759, in all
    return self._iter().all()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/query.py", line 2897, in _iter
    execution_options={"_sa_orm_load_options": self.load_options},
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1688, in execute
    conn = self._connection_for_bind(bind)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1530, in _connection_for_bind
    engine, execution_options
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 747, in _connection_for_bind
    conn = bind.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3197, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3276, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3247, in _wrap_pool_connect
    e, dialect, self
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2101, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3243, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 310, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 868, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 476, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 146, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 143, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 256, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 371, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 666, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/create.py", line 590, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 584, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2024-05-24T11:56:31.127+0000] {processor.py:156} INFO - Started process (PID=155) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:56:31.139+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:56:31.140+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:56:31.139+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:57:05.080+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:57:03.184+0000] {timeout.py:68} ERROR - Process timed out, PID: 155
[2024-05-24T11:57:16.574+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:57:07.717+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 4, in <module>
    import pandas as pd
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/__init__.py", line 22, in <module>
    from pandas.compat import (
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/compat/__init__.py", line 15, in <module>
    from pandas.compat.numpy import (
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/compat/numpy/__init__.py", line 7, in <module>
    from pandas.util.version import Version
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/util/__init__.py", line 7, in <module>
    from pandas.core.util.hashing import (  # noqa
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/util/hashing.py", line 17, in <module>
    from pandas._libs import lib
  File "pandas/_libs/lib.pyx", line 1, in init pandas._libs.lib
  File "<frozen importlib._bootstrap>", line 194, in _lock_unlock_module
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/dags1.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#reducing-dag-complexity, PID: 155
[2024-05-24T11:57:18.133+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:57:39.723+0000] {processor.py:181} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3243, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 310, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 868, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 476, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 146, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 143, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 256, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 371, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 666, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/create.py", line 590, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 584, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: could not translate host name "postgres" to address: Temporary failure in name resolution


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 177, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 161, in _handle_dag_file_processing
    callback_requests=callback_requests,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 75, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 771, in process_file
    self.update_import_errors(session, dagbag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 558, in update_import_errors
    existing_import_error_files = [x.filename for x in session.query(errors.ImportError.filename).all()]
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/query.py", line 2759, in all
    return self._iter().all()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/query.py", line 2897, in _iter
    execution_options={"_sa_orm_load_options": self.load_options},
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1688, in execute
    conn = self._connection_for_bind(bind)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1530, in _connection_for_bind
    engine, execution_options
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 747, in _connection_for_bind
    conn = bind.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3197, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3276, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3247, in _wrap_pool_connect
    e, dialect, self
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2101, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3243, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 310, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 868, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 476, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 146, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 143, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 256, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 371, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 666, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/create.py", line 590, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 584, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2024-05-24T11:57:50.338+0000] {processor.py:156} INFO - Started process (PID=156) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:57:50.342+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:57:50.343+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:57:50.343+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T11:58:24.176+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:58:24.170+0000] {timeout.py:68} ERROR - Process timed out, PID: 156
[2024-05-24T11:58:24.249+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:58:24.198+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 4, in <module>
    import pandas as pd
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/__init__.py", line 22, in <module>
    from pandas.compat import (
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/compat/__init__.py", line 15, in <module>
    from pandas.compat.numpy import (
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/compat/numpy/__init__.py", line 7, in <module>
    from pandas.util.version import Version
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/util/__init__.py", line 1, in <module>
    from pandas.util._decorators import (  # noqa
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/util/_decorators.py", line 14, in <module>
    from pandas._libs.properties import cache_readonly  # noqa
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/_libs/__init__.py", line 13, in <module>
    from pandas._libs.interval import Interval
  File "pandas/_libs/interval.pyx", line 1, in init pandas._libs.interval
  File "pandas/_libs/hashtable.pyx", line 1, in init pandas._libs.hashtable
  File "pandas/_libs/missing.pyx", line 1, in init pandas._libs.missing
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/_libs/tslibs/__init__.py", line 31, in <module>
    from pandas._libs.tslibs.conversion import (
  File "pandas/_libs/tslibs/conversion.pyx", line 63, in init pandas._libs.tslibs.conversion
  File "pandas/_libs/tslibs/parsing.pyx", line 1, in init pandas._libs.tslibs.parsing
  File "pandas/_libs/tslibs/offsets.pyx", line 1, in init pandas._libs.tslibs.offsets
  File "<frozen importlib._bootstrap>", line 416, in parent
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/dags1.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#reducing-dag-complexity, PID: 156
[2024-05-24T11:58:24.251+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T11:58:34.287+0000] {processor.py:181} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3243, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 310, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 868, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 476, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 146, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 143, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 256, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 371, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 666, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/create.py", line 590, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 584, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: could not translate host name "postgres" to address: Temporary failure in name resolution


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 177, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 161, in _handle_dag_file_processing
    callback_requests=callback_requests,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 75, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 771, in process_file
    self.update_import_errors(session, dagbag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/dag_processing/processor.py", line 558, in update_import_errors
    existing_import_error_files = [x.filename for x in session.query(errors.ImportError.filename).all()]
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/query.py", line 2759, in all
    return self._iter().all()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/query.py", line 2897, in _iter
    execution_options={"_sa_orm_load_options": self.load_options},
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1688, in execute
    conn = self._connection_for_bind(bind)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1530, in _connection_for_bind
    engine, execution_options
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 747, in _connection_for_bind
    conn = bind.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3197, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3276, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3247, in _wrap_pool_connect
    e, dialect, self
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2101, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 3243, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 310, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 868, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 476, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 146, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 143, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 256, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 371, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 666, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/create.py", line 590, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 584, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2024-05-24T11:59:05.363+0000] {processor.py:156} INFO - Started process (PID=158) to work on /opt/airflow/dags/dags1.py
[2024-05-24T11:59:05.374+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T11:59:05.375+0000] {logging_mixin.py:117} INFO - [2024-05-24T11:59:05.375+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T12:00:03.918+0000] {processor.py:156} INFO - Started process (PID=161) to work on /opt/airflow/dags/dags1.py
[2024-05-24T12:00:03.944+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T12:00:03.947+0000] {logging_mixin.py:117} INFO - [2024-05-24T12:00:03.947+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T12:00:50.364+0000] {processor.py:156} INFO - Started process (PID=164) to work on /opt/airflow/dags/dags1.py
[2024-05-24T12:00:50.493+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T12:00:50.842+0000] {logging_mixin.py:117} INFO - [2024-05-24T12:00:50.686+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T12:01:21.900+0000] {logging_mixin.py:117} INFO - [2024-05-24T12:01:21.228+0000] {timeout.py:68} ERROR - Process timed out, PID: 164
[2024-05-24T12:01:50.583+0000] {logging_mixin.py:117} INFO - [2024-05-24T12:01:24.711+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 4, in <module>
    import pandas as pd
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/__init__.py", line 22, in <module>
    from pandas.compat import (
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/compat/__init__.py", line 15, in <module>
    from pandas.compat.numpy import (
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/compat/numpy/__init__.py", line 7, in <module>
    from pandas.util.version import Version
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/util/__init__.py", line 1, in <module>
    from pandas.util._decorators import (  # noqa
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/util/_decorators.py", line 14, in <module>
    from pandas._libs.properties import cache_readonly  # noqa
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/_libs/__init__.py", line 13, in <module>
    from pandas._libs.interval import Interval
  File "pandas/_libs/interval.pyx", line 1, in init pandas._libs.interval
  File "pandas/_libs/hashtable.pyx", line 1, in init pandas._libs.hashtable
  File "pandas/_libs/missing.pyx", line 1, in init pandas._libs.missing
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/_libs/tslibs/__init__.py", line 31, in <module>
    from pandas._libs.tslibs.conversion import (
  File "pandas/_libs/tslibs/conversion.pyx", line 63, in init pandas._libs.tslibs.conversion
  File "pandas/_libs/tslibs/parsing.pyx", line 1, in init pandas._libs.tslibs.parsing
  File "pandas/_libs/tslibs/offsets.pyx", line 1, in init pandas._libs.tslibs.offsets
  File "pandas/_libs/tslibs/timedeltas.pyx", line 61, in init pandas._libs.tslibs.timedeltas
  File "pandas/_libs/tslibs/fields.pyx", line 49, in init pandas._libs.tslibs.fields
  File "pandas/_libs/tslibs/strptime.pyx", line 633, in init pandas._libs.tslibs.strptime
  File "pandas/_libs/tslibs/strptime.pyx", line 571, in pandas._libs.tslibs.strptime.TimeRE.__init__
  File "pandas/_libs/tslibs/strptime.pyx", line 616, in pandas._libs.tslibs.strptime.TimeRE.pattern
  File "/usr/local/lib/python3.7/re.py", line 309, in _subx
    def _subx(pattern, template):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/dags1.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#reducing-dag-complexity, PID: 164
[2024-05-24T12:01:52.478+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T12:01:52.539+0000] {processor.py:156} INFO - Started process (PID=165) to work on /opt/airflow/dags/dags1.py
[2024-05-24T12:01:52.541+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T12:01:52.547+0000] {logging_mixin.py:117} INFO - [2024-05-24T12:01:52.546+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T12:02:40.100+0000] {processor.py:156} INFO - Started process (PID=168) to work on /opt/airflow/dags/dags1.py
[2024-05-24T12:02:40.398+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T12:02:40.566+0000] {logging_mixin.py:117} INFO - [2024-05-24T12:02:40.482+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T12:03:15.219+0000] {logging_mixin.py:117} INFO - [2024-05-24T12:03:14.520+0000] {timeout.py:68} ERROR - Process timed out, PID: 168
[2024-05-24T12:03:23.678+0000] {logging_mixin.py:117} INFO - [2024-05-24T12:03:18.909+0000] {dagbag.py:330} ERROR - Failed to import: /opt/airflow/dags/dags1.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 326, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/dags1.py", line 4, in <module>
    import pandas as pd
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/__init__.py", line 22, in <module>
    from pandas.compat import (
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/compat/__init__.py", line 15, in <module>
    from pandas.compat.numpy import (
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/compat/numpy/__init__.py", line 7, in <module>
    from pandas.util.version import Version
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/util/__init__.py", line 1, in <module>
    from pandas.util._decorators import (  # noqa
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/util/_decorators.py", line 14, in <module>
    from pandas._libs.properties import cache_readonly  # noqa
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/_libs/__init__.py", line 13, in <module>
    from pandas._libs.interval import Interval
  File "pandas/_libs/interval.pyx", line 1, in init pandas._libs.interval
  File "pandas/_libs/hashtable.pyx", line 1, in init pandas._libs.hashtable
  File "pandas/_libs/missing.pyx", line 1, in init pandas._libs.missing
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/_libs/tslibs/__init__.py", line 31, in <module>
    from pandas._libs.tslibs.conversion import (
  File "pandas/_libs/tslibs/conversion.pyx", line 63, in init pandas._libs.tslibs.conversion
  File "<frozen importlib._bootstrap>", line 416, in parent
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/dags1.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.4.1/best-practices.html#reducing-dag-complexity, PID: 168
[2024-05-24T12:03:23.681+0000] {processor.py:770} WARNING - No viable dags retrieved from /opt/airflow/dags/dags1.py
[2024-05-24T12:03:32.327+0000] {processor.py:156} INFO - Started process (PID=170) to work on /opt/airflow/dags/dags1.py
[2024-05-24T12:03:32.328+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T12:03:32.329+0000] {logging_mixin.py:117} INFO - [2024-05-24T12:03:32.329+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T12:06:44.935+0000] {processor.py:156} INFO - Started process (PID=42) to work on /opt/airflow/dags/dags1.py
[2024-05-24T12:06:44.939+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T12:06:44.939+0000] {logging_mixin.py:117} INFO - [2024-05-24T12:06:44.939+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
[2024-05-24T12:09:18.339+0000] {processor.py:156} INFO - Started process (PID=45) to work on /opt/airflow/dags/dags1.py
[2024-05-24T12:09:18.348+0000] {processor.py:758} INFO - Processing file /opt/airflow/dags/dags1.py for tasks to queue
[2024-05-24T12:09:18.357+0000] {logging_mixin.py:117} INFO - [2024-05-24T12:09:18.357+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/airflow/dags/dags1.py
